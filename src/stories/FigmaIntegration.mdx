import { Meta } from '@storybook/blocks';

<Meta title="Documentation/Figma Integration" />

# üé® Integra√ß√£o com Figma

Este Design System usa o **@storybook/addon-designs** para integrar designs do Figma diretamente no Storybook.

## ‚ö†Ô∏è Perguntas Frequentes

### O Figma precisa estar publicado?
**N√£o precisa publica√ß√£o oficial**, mas:
- **Arquivos p√∫blicos**: Funcionam imediatamente com qualquer URL
- **Arquivos privados**: Precisam de um **Personal Access Token** do Figma
- **Arquivos do seu time**: Qualquer pessoa do time com acesso pode visualizar

### As edi√ß√µes no Figma refletem no Storybook?
**‚úÖ SIM!** A integra√ß√£o √© em tempo real:
- Edite o design no Figma
- Salve as altera√ß√µes (Cmd/Ctrl + S)
- Recarregue a p√°gina do Storybook
- O design atualizado aparece automaticamente

O addon carrega o iframe do Figma, ent√£o sempre mostra a vers√£o mais recente do arquivo.

### Posso editar do Storybook para o Figma?
**‚ùå N√ÉO.** A integra√ß√£o √© **somente leitura (read-only)**:
- Voc√™ visualiza o design do Figma dentro do Storybook
- N√£o pode fazer altera√ß√µes no design pelo Storybook
- √â apenas um embed/iframe do Figma
- Para editar, precisa abrir o Figma diretamente

**Fluxo de trabalho:**
```
Figma (Design) ‚Üí Storybook (Refer√™ncia) ‚Üí C√≥digo (Implementa√ß√£o)
     ‚Üë                                              ‚Üì
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Feedback ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Como Usar

### 1. Obter URL do Figma

No Figma, abra o arquivo de design e:
1. Selecione o frame/component que deseja vincular
2. Clique com o bot√£o direito ‚Üí **Copy link**
3. Ou use o bot√£o **Share** no canto superior direito

A URL ter√° este formato:
```
https://www.figma.com/file/ABC123/Design-System?node-id=1234:5678
```

### 2. Adicionar na Story

Adicione o par√¢metro `design` na configura√ß√£o da story:

```tsx
import type { Meta, StoryObj } from '@storybook/react';
import { Button } from './button';

const meta = {
  title: 'Components/Button',
  component: Button,
  parameters: {
    layout: 'centered',
    // üëá Adicione aqui
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/ABC123/Design-System?node-id=1234:5678',
    },
  },
} satisfies Meta<typeof Button>;

export default meta;
type Story = StoryObj<typeof meta>;

export const Primary: Story = {
  args: {
    children: 'Button',
  },
  // Pode sobrescrever o design por variante
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/ABC123/Design-System?node-id=9999:0000',
    },
  },
};
```

### 3. Visualizar no Storybook

Ap√≥s adicionar a URL, uma nova aba **Design** aparecer√° no painel inferior do Storybook, mostrando o design do Figma embutido.

## Tipos de Integra√ß√£o Suportados

O addon suporta v√°rias ferramentas:

### Figma
```tsx
design: {
  type: 'figma',
  url: 'https://www.figma.com/file/...',
}
```

### FigSpec (Figma + Anota√ß√µes)
```tsx
design: {
  type: 'figspec',
  url: 'https://www.figma.com/file/...',
  accessToken: 'seu-token-figma', // Opcional para arquivos privados
}
```

### M√∫ltiplos Designs
```tsx
design: [
  {
    type: 'figma',
    name: 'Desktop',
    url: 'https://www.figma.com/file/.../desktop',
  },
  {
    type: 'figma',
    name: 'Mobile',
    url: 'https://www.figma.com/file/.../mobile',
  },
]
```

### Outras Ferramentas
```tsx
// Adobe XD
design: {
  type: 'link',
  url: 'https://xd.adobe.com/...',
}

// InVision
design: {
  type: 'iframe',
  url: 'https://invis.io/...',
}

// Sketch Cloud
design: {
  type: 'link',
  url: 'https://www.sketch.com/s/...',
}

// PDF
design: {
  type: 'pdf',
  url: '/designs/component-spec.pdf',
}

// Imagem
design: {
  type: 'image',
  url: '/designs/component-mockup.png',
}
```

## Organiza√ß√£o Recomendada

### Por Componente
Adicione o design principal no `meta` e varia√ß√µes espec√≠ficas em cada story:

```tsx
const meta = {
  title: 'Components/Button',
  component: Button,
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/file/ABC/Button-Component',
    },
  },
} satisfies Meta<typeof Button>;

export const Primary: Story = {
  // Usa o design do meta por padr√£o
};

export const Outlined: Story = {
  parameters: {
    design: {
      type: 'figma',
### Quando voc√™ precisa de Access Token?

- ‚úÖ Arquivo p√∫blico: **N√£o precisa** (funciona direto)
- ‚úÖ Arquivo do seu time: **N√£o precisa** (se voc√™ tem acesso)
- ‚ùå Arquivo privado de outro time: **Precisa de token**

### Como obter e configurar:

1. **Gerar token no Figma:**
   - V√° em **Figma ‚Üí Settings ‚Üí Account ‚Üí Personal access tokens**
   - Clique em **Generate new token**
   - D√™ um nome (ex: "Storybook Design System")
   - Copie o token (come√ßa com `figd_`)

2. **Adicionar ao projeto:**
   ```bash
   # .env.local (criar na raiz do projeto)
   STORYBOOK_FIGMA_ACCESS_TOKEN=figd_your_token_here
   ```

3. **Usar na story:**
   ```tsx
   design: {
     type: 'figma',
     url: 'https://www.figma.com/file/...',
     accessToken: process.env.STORYBOOK_FIGMA_ACCESS_TOKEN,
   }
   ```

4. **Adicionar ao .gitignore:**
   ```
   .env.local
   .env*.local
   ```

‚ö†Ô∏è **Seguran√ßa**: 
- Nunca commite tokens no Git
- Use vari√°veis de ambiente
- Revogue tokens antigos quando n√£o usar mais
- Cada desenvolvedor deve ter seu pr√≥prio token

// Patterns
design: {
  type: 'figma',
  url: 'https://www.figma.com/file/ABC/Patterns',
}
```

## Arquivos Privados do Figma

Para acessar arquivos privados, voc√™ precisa de um token de acesso:

1. V√° em **Figma ‚Üí Settings ‚Üí Personal access tokens**
2. Gere um novo token
3. Adicione ao `.env.local`:

```bash
STORYBOOK_FIGMA_ACCESS_TOKEN=figd_your_token_here
```

4. Use na story:

```tsx
design: {
  type: 'figma',
  url: 'https://www.figma.com/file/...',
  accessToken: process.env.STORYBOOK_FIGMA_ACCESS_TOKEN,
}
```

‚ö†Ô∏è **Seguran√ßa**: Nunca commite tokens no Git. Use vari√°veis de ambiente.

## Exemplo Completo

```tsx
import type { Meta, StoryObj } from '@storybook/react';
import { Card } from './card';

const meta = {
  title: 'Components/Card',
  component: Card,
  parameters: {
    layout: 'centered',
    design: [
      {
        type: 'figma',
        name: 'Design Desktop',
        url: 'https://www.figma.com/file/ABC/Card?node-id=100:200',
      },
      {
        type: 'figma',
        name: 'Design Mobile',
        url: 'https://www.figma.com/file/ABC/Card?node-id=100:300',
      },
      {
        type: 'link',
        name: 'Documenta√ß√£o',
        url: 'https://design-system.com/docs/card',
      },
    ],
  },
} satisfies Meta<typeof Card>;

export default meta;
type Story = StoryObj<typeof meta>;

expSincroniza√ß√£o Design ‚Üî C√≥digo

### Workflow Recomendado:

1. **Designer cria/atualiza no Figma**
   - Edita componente no Figma
   - Salva (autom√°tico no Figma)
   - Copia URL do frame espec√≠fico

2. **Designer atualiza Storybook**
   - Adiciona/atualiza URL na story
   - Commit: "docs: update Button Figma design"
   - Push para o reposit√≥rio

3. **Dev visualiza no Storybook**
   - Abre story do componente
   - V√™ design atualizado na aba Design
   - Compara com implementa√ß√£o atual
   - Identifica mudan√ßas necess√°rias

4. **Dev implementa mudan√ßas**
   - Ajusta c√≥digo do componente
   - Valida com design do Figma lado a lado
   - Commit: "feat: update Button with new design specs"

5. **QA valida**
   - Compara Storybook (implementa√ß√£o) com Figma (design)
   - Aba Design mostra vers√£o sempre atualizada
   - Sem necessidade de abrir Figma separadamente

### Benef√≠cios desta integra√ß√£o:

‚úÖ **Centraliza√ß√£o**: Design e c√≥digo no mesmo lugar  
‚úÖ **Sempre atualizado**: Figma reflete em tempo real  
‚úÖ **Menos ferramentas**: N√£o precisa alternar entre Figma e Storybook  
‚úÖ **Refer√™ncia visual**: Devs veem o design durante implementa√ß√£o  
‚úÖ **Handoff simplificado**: URL do Figma √© a documenta√ß√£o  

### Limita√ß√µes:

‚ùå N√£o edita Figma pelo Storybook (somente visualiza√ß√£o)  
‚ùå Precisa acesso ao Figma para ver designs privados  
‚ùå Requer conex√£o com internet (carrega iframe do Figma)  
‚ùå Performance depende do Figma (se Figma estiver lento, iframe tamb√©m)  

## Pr√≥ximos Passos

1. **Organize arquivo Figma** com todos os componentes do Design System
2. **Vincule cada componente** usando o node-id espec√≠fico de cada frame
3. **Documente estados** (hover, active, disabled, focus, etc.)
4. **Adicione anota√ß√µes** com specs de spacing, typography, colors
5. **Configure Dev Mode** no Figma para inspecionar propriedades CSS
6. **Mantenha sincronizado** - atualize URLs quando redesenhar componentes
  args: {
    children: <p>Interactive card</p>,
  },
  parameters: {
    design: {
      type: 'figma',
      url: 'https://www.figma.com/proto/ABC/Card-Interactive?node-id=400:500',
    },
  },
};
```

## Pr√≥ximos Passos

1. **Crie arquivo Figma** com todos os componentes do Design System
2. **Vincule cada componente** usando o node-id espec√≠fico
3. **Documente estados** (hover, active, disabled, etc.)
4. **Adicione anota√ß√µes** com specs de spacing, typography, colors
5. **Mantenha sincronizado** com as implementa√ß√µes no c√≥digo

## Recursos

- [Addon Designs Documentation](https://github.com/storybookjs/addon-designs)
- [Figma API](https://www.figma.com/developers/api)
- [Best Practices](https://storybook.js.org/docs/writing-stories/design-system)
